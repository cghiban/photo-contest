<!DOCTYPE html>
<html>
    <head>
    {{template "header_head" .}}
    <title>Entry Form</title>
    <style>
    input, textarea {
        width: 100%;
    }
    </style>
    </head>
    <body>
    {{template "header_body" .}}
    <div class="p-5" style="margin-left: auto; margin-right: auto; max-width: 1200px; display: block; border: 1px solid #000; padding">
	<h5 align="center"><b><i>All the World in New York City</i> Photography Contest</b></h5>
    {{if .Edit}}
    <h1 align="center">Update Entry</h1>
    {{else}}
    <h1 align="center">Entry Form</h1>
    {{end}}
    <div align="center">
		<p class="small">REMINDER: A completed, signed photo release is required for each subject:
		<a target="_blank" href="./assets/All-the-World-in-NY-City-Photo-Release.pdf" >Download photo release form</a></p>
	</div>
	<h5 class="mt-3"><b>Use Rights Agreement</b></h5>
    <div class="col-sm-10">
    <p>I hereby grant to Cold Spring Harbor Laboratory (“CSHL”) a license to reproduce, distribute, create derivative works of, publicly display and otherwise use (including in printed or electronic media) the photograph submitted by me to the CSHL DNA Learning Center’s “<i>All the World in New York City</i>” Photography Contest (collectively, “Licensed Photo”).  I warrant that I own all rights necessary to grant this license to CSHL, that no permission is required from any other party for CSHL to use the Licensed Photo, and that the Licensed Photo does not infringe the copyright or other proprietary or other right of any person.  I will indemnify CSHL against any liability, damage, loss or expense that CSHL may incur based on its use of the Licensed Photo as permitted.
    </p></div>
    {{if .Edit}}
    <form id="form" enctype="multipart/form-data" method="POST" action="./entry?id={{.ID}}" onsubmit="return validateForm()">
    {{else}}
    <form id="form" enctype="multipart/form-data" method="POST" action="./entry" onsubmit="return validateForm()">
    {{end}}
        <input type="hidden" id="full_name" name="full_name" value="{{.RealName}}">
        {{ .csrfField }}
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="signature" class="fw-bold">Digital Signature</label>
            </div>
            <div class="col-sm-9">
                <input oninput="clearCustomValidity()" type="text" id="signature" name="signature" value="{{ .Signature }}" required="">
            </div>
        </div>
        <div class="mb-3 mt-5 row" style="border-top: 1px solid #000;">
        <div class="mb-3 mt-3">
	    <h5><b>Who is in the photo?</b></h5>
	</div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="sname" class="fw-bold">Subject's Name(s)</label>
            </div>
            <div class="col-sm-9">
                <input type="text" name="sname" value="{{ html .SubjectName }}" required="">
                <p><small>List left to right and separate by comma if multiple people are included in the image.</small></p>
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="sage" class="fw-bold">Subject's Age(s)</label>
            </div>
            <div class="col-sm-9">
                <input type="text" name="sage" value="{{ html .SubjectAge }}" required="">
                <p><small>List left to right and separate by comma if multiple people are included in the image.</small></p>
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="scountry" class="fw-bold">Subject's Countr(y/ies) of Birth</label>
            </div>
            <div class="col-sm-9">
                <input type="text" name="scountry" value="{{ html .SubjectCountry }}" required="">
                <p><small>List left to right and separate by comma if multiple people are included in the image.</small></p>
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="sorigin" class="fw-bold">Subject's Ancestral Countr(y/ies) of Origin (if born in US)</label>
            </div>
            <div class="col-sm-9">
                <input type="text" name="sorigin" value="{{ html .SubjectOrigin }}">
                <p><small>List left to right and separate by comma if multiple people are included in the image</small></p>
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="location" class="fw-bold">Where in NYC was photograph taken?</label>
            </div>
            <div class="col-sm-9">
                <input type="text" name="location" value="{{ html .Location }}" required="">
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="sbiography" class="fw-bold">Descriptive Biography of Subject(s)
                </label>
                <p><small>Characters with spaces: 250 minimum, 500 maximum</small></p>
            </div>
            <div class="col-sm-9">
                <textarea oninput="showBioValidity();" id="sbiography" name="sbiography" minlength="250" maxlength="500" required="">{{ html .SubjectBiography }}</textarea>
				<p><small>Prompt stops when 250 character minimum is reached; typing is disabled when 500 character maximum is reached.</small></p>
            </div>
        </div>
        {{if not .Edit}}
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="file" class="fw-bold">Upload Digital File</label>
			</div>
            <div class="col-sm-9">
                <input type="file" accept="image/png,image/jpeg" name="file" required="">
				<p><small>2000 pixels on longest side at 72 DPI, 10 MB or less, file name Lastname-FirstInitial-Image#.jpg</small></p>
            </div>
        </div>
        <div class="mb-3 row">
            <div class="col-sm-3">
                <label for="release" class="fw-bold">Upload Photo Release Form</label>
            </div>
            <div class="col-sm-9">
                <input type="file" accept="application/pdf,image/jpeg,image/png" name="release" required="">
				<p><small>PDF, jpg, and png files allowed. For images with multiple subjects combine each release into one, multi-page file.</small></p>
            </div>
        </div>
        {{end}}
        <div align="center">
          {{if .Edit}}
          <button id="submit" class="btn btn-primary" onclick="hideMessage()">Update Entry</button>
          {{else}}
          <button id="submit" class="btn btn-primary" onclick="hideMessage()">Submit Entry</button>&emsp;
          <button type="button" id="clear" class="btn btn-primary" onclick="clearForm()">Clear Form</button>
          {{end}}
        </div>
      </div>
    </form>
    </div>
    <script>
    function showBioValidity() {
      document.getElementById("sbiography").reportValidity();
    }
    function clearForm() {
      const form = document.getElementById("form");
      var allTextInputs = form.querySelectorAll("input[type='text']");
      Array.from(allTextInputs ).forEach( function( el ) {
        el.value = "";
      });
      document.getElementById("sbiography").value = "";
    }
    function clearCustomValidity() {
      const signature_field = document.getElementById("signature");
      signature_field.setCustomValidity('');
    }
    function hideMessage() {
      const message = document.getElementById("message");
      if (message) {
        message.parentNode.removeChild(message);
      }
    }
    function validateForm() {
      const full_name = document.getElementById("full_name").value;
      const signature_field = document.getElementById("signature");
      if (full_name != signature_field.value) {
          signature_field.setCustomValidity('Must be the same as the name in your profile.');
          signature_field.reportValidity();
          return false;
      }
      return true;
    }
    </script>
    {{template "footer" .}}
    </body>
</html>
